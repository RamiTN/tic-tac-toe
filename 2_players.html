<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tic-Tac-Toe Game</title>
    <style>
      body {
        background-color: rgb(0, 0, 0);
        color: white;
        font-family: Arial, sans-serif;
      }
      .column-tictac {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        background-color: transparent;
        padding: 10px;
        height: 500px;
        width: 500px;
        margin: 0 auto;
      }
      .column-tic {
        border: 5px double rgba(255, 0, 0, 0.8);
        padding: 20px;
        font-size: 30px;
        text-align: center;
        cursor: pointer;
      }
      h1,
      p {
        text-align: center;
      }
      h1 {
        color: #ff0000;
      }
      .cercle,
      .tick {
        height: 70px;
        width: 70px;
        border: double white 5px;
        background-color: transparent;
        display: none;
        margin: 0 auto;
        vertical-align: middle;
      }
      .cercle {
        border-radius: 50%;
        box-shadow: 0 0 10px 5px blue;
      }
      .tick {
        box-shadow: 0 0 10px 5px rgb(255, 0, 0);
        transform: rotateZ(45deg);
      }
    </style>
  </head>
  <body>
    <h1>Tic-Tac-Toe Game</h1>
    <p>Click on a cell to make a move. Player 1 is X and Player 2 is O.</p>
    <audio
      autoplay
      id="background-audio"
      src="Dua-Lipa-New-Rules-_Official-Instrumental_.ogg"
    ></audio>
    <div class="column-tictac">
      <div class="column-tic" onclick="makeMove(this, 0)">
        <div class="cercle"></div>
        <div class="tick"></div>
      </div>
      <div class="column-tic" onclick="makeMove(this, 1)">
        <div class="cercle"></div>
        <div class="tick"></div>
      </div>
      <div class="column-tic" onclick="makeMove(this, 2)">
        <div class="cercle"></div>
        <div class="tick"></div>
      </div>
      <div class="column-tic" onclick="makeMove(this, 3)">
        <div class="cercle"></div>
        <div class="tick"></div>
      </div>
      <div class="column-tic" onclick="makeMove(this, 4)">
        <div class="cercle"></div>
        <div class="tick"></div>
      </div>
      <div class="column-tic" onclick="makeMove(this, 5)">
        <div class="cercle"></div>
        <div class="tick"></div>
      </div>
      <div class="column-tic" onclick="makeMove(this, 6)">
        <div class="cercle"></div>
        <div class="tick"></div>
      </div>
      <div class="column-tic" onclick="makeMove(this, 7)">
        <div class="cercle"></div>
        <div class="tick"></div>
      </div>
      <div class="column-tic" onclick="makeMove(this, 8)">
        <div class="cercle"></div>
        <div class="tick"></div>
      </div>
    </div>
    <script>
      let board;
      let currentPlayer;
      const winPatterns = [
        [0, 1, 2],
        [3, 4, 5],
        [6, 7, 8],
        [0, 3, 6],
        [1, 4, 7],
        [2, 5, 8],
        [0, 4, 8],
        [2, 4, 6],
      ];

      function startGame() {
        board = Array.from(Array(9).keys());
        currentPlayer = "Player 1";
        const cells = document.querySelectorAll(".column-tic");
        cells.forEach((cell) => {
          cell.querySelector(".cercle").style.display = "none";
          cell.querySelector(".tick").style.display = "none";
          cell.style.pointerEvents = "auto";
        });

        var audio = document.getElementById("background-audio");
        var playPromise = audio.play();

        if (playPromise !== undefined) {
          playPromise.catch((error) => {
            console.log("Autoplay failed: ", error);
            document.body.addEventListener(
              "click",
              () => {
                audio.play();
              },
              { once: true }
            );
          });
        }
      }

      function makeMove(cell, index) {
        if (typeof board[index] === "number") {
          board[index] = currentPlayer;
          if (currentPlayer === "Player 1") {
            cell.querySelector(".tick").style.display = "block";
          } else {
            cell.querySelector(".cercle").style.display = "block";
          }
          if (checkWin(board, currentPlayer)) {
            gameOver(currentPlayer + " Wins!");
          } else if (checkTie()) {
            gameOver("Tie");
          } else {
            currentPlayer =
              currentPlayer === "Player 1" ? "Player 2" : "Player 1";
          }
        }
      }

      function checkWin(board, player) {
        return winPatterns.some((pattern) => {
          return pattern.every((index) => board[index] === player);
        });
      }

      function gameOver(message) {
        const cells = document.querySelectorAll(".column-tic");
        cells.forEach((cell) => (cell.style.pointerEvents = "none"));
        setTimeout(() => alert(message), 100);
        setTimeout(() => startGame(), 2000);
      }

      function checkTie() {
        return board.every((cell) => typeof cell !== "number");
      }

      window.onload = startGame;
    </script>
  </body>
</html>
